(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["business"],{2040:function(e,t,n){},"25eb":function(e,t,n){var o=n("23e7"),i=n("c20d");o({target:"Number",stat:!0,forced:Number.parseInt!=i},{parseInt:i})},3321:function(e,t,n){"use strict";n("2040")},"6aab":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{staticClass:"flex-column",attrs:{fluid:"","fill-height":"","pa-0":""}},[n("transition",{attrs:{name:"fade"}},[e.loading?n("div",{staticClass:"map-loading"}):e._e()]),n("transition",{attrs:{name:"fade",mode:"out-in",tag:"div"}},[e.mapList?e._e():n("div",{key:1,staticStyle:{flex:"1","min-width":"100%"}},[n("Map",{attrs:{organizations:e.organizations}})],1),e.mapList?n("v-container",{key:2},[n("div",{staticClass:"text-h3 my-6 my-sm-12 ml-3"},[e._v("Список объектов")]),n("v-list",[e._l(e.organizations,(function(t,o){return[n("v-list-item",{key:o,attrs:{"three-line":""}},[n("v-list-item-content",[n("v-list-item-title",[e._v(e._s(t.Caption))]),n("v-list-item-subtitle",[e._v("Адрес: "+e._s(t.Contact.Address))]),n("v-list-item-subtitle",[e._v("Телефон: "+e._s(t.Contact.Phone))])],1),n("v-list-item-action",[n("div",{staticClass:"d-flex"},[e._l(t.Dostup,(function(o,i){return[2===t.Dostup[i]?n("v-icon",{key:i,staticClass:"ml-3",attrs:{color:"success"}},[e._v(e._s(e.mapIcons[i]))]):e._e()]}))],2)])],1),n("v-divider",{key:"divider-"+o})]}))],2)],1):e._e()],1)],1)},i=[],a=(n("99af"),n("96cf"),n("1da1")),r=n("5530"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"map"}})},c=[],l=(n("d81d"),n("a9e3"),n("c35a"),n("4160"),n("45fc"),n("25eb"),n("d3b7"),n("159b"),n("2909")),u={data:function(){return{googleApis:{API_KEY:"AIzaSyAxu1PqQlh8psyP0hmahMdc6uWkspPi_JI",autocompleteService:null,predictions:null,sessionToken:null,loading:!1,map:null,LatLng:{lat:56.8119915,lng:60.4772995},markers:{type:"FeatureCollection",features:[]},taskColorMap:{A:"c00",B:"dd0",C:"00c",D:"555"},directionsService:null,directionsRenderer:null,minZoomLevel:8}}},methods:{loadMapScript:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){if("google"in window)return t();if(!("loadingGoogleEvent"in window)){window.loadingGoogleEvent=new Event("googleLoaded");var n=document.createElement("script");n.type="text/javascript",n.defer=!0,n.src="https://maps.googleapis.com/maps/api/js?key=".concat(e.googleApis.API_KEY,"&libraries=places"),n.onload=function(){console.log("google map script loaded"),document.dispatchEvent(window.loadingGoogleEvent)},document.body.appendChild(n)}document.addEventListener("googleLoaded",(function(){return t()}))})));case 1:case"end":return t.stop()}}),t)})))()},initMapPlaces:function(){console.log("init places map api"),this.$set(this.googleApis,"sessionToken",new window.google.maps.places.AutocompleteSessionToken),this.$set(this.googleApis,"autocompleteService",new window.google.maps.places.AutocompleteService)},initMap:function(){var e=this;console.log("init map api");var t=new window.google.maps.Map(document.getElementById("map"),{zoom:8,center:this.googleApis.LatLng});this.$set(this.googleApis,"map",t),t.data.addListener("click",(function(t){e.$emit("google.data.click",t)}))},initDirections:function(){console.log("init directions api"),this.$set(this.googleApis,"directionsService",new window.google.maps.DirectionsService),this.$set(this.googleApis,"directionsRenderer",new window.google.maps.DirectionsRenderer({suppressMarkers:!0})),this.googleApis.directionsRenderer.setMap(this.googleApis.map)},searchPlaces:function(e){var t=this;this.$set(this.googleApis,"loading",!0),this.googleApis.autocompleteService.getPlacePredictions({input:e,sessionToken:this.googleApis.sessionToken,types:["geocode"]},(function(e,n){"OK"===n&&t.$set(t.googleApis,"predictions",e),t.$set(t.googleApis,"loading",!1)}))},getLonLat:function(e){return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){var n=new window.google.maps.Geocoder,o={longitude:"",latitude:""};n.geocode({placeId:e},(function(e,n){return"OK"===n&&(o={longitude:e[0].geometry.location.lng(),latitude:e[0].geometry.location.lat()}),t(o)}))})));case 1:case"end":return t.stop()}}),t)})))()},getLocation:function(e){return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){var n=new window.google.maps.Geocoder;n.geocode({placeId:e},(function(e,n){var o=null;return"OK"===n&&(o=e[0].geometry.location),t(o)}))})));case 1:case"end":return t.stop()}}),t)})))()},setPos:function(e){this.googleApis.map.panTo(e)},setMarkers:function(e){var t,n,o=this;null===(t=this.googleApis.map)||void 0===t||null===(n=t.data)||void 0===n||n.forEach((function(t){var n=t.getId(),i=e.features.some((function(e){return Number.parseInt(n)===Number.parseInt(e.id)}));i||o.googleApis.map.data.remove(t)})),e.features.forEach((function(e){var t=new window.google.maps.Data.Feature({id:e.id,properties:e.properties,geometry:{lat:e.geometry.coordinates[1],lng:e.geometry.coordinates[0]}});o.googleApis.map.data.contains(o.googleApis.map.data.getFeatureById(e.id))||o.googleApis.map.data.add(t)})),this.googleApis.map.data.setStyle((function(e){var t=e.getProperty("text")||"",n=e.getProperty("color")||"0075FF",o=e.getProperty("icon")||"";return{icon:{url:"https://cdn.mapmarker.io/api/v1/pin?size=190&text=".concat(t,"&icon=").concat(o,"&size=40&background=").concat(n,"&color=FFF&hoffset=-1")}}})),e.features.length&&this.zoom()},zoom:function(){var e=this,t=new window.google.maps.LatLngBounds;this.googleApis.map.data.forEach((function(n){e.processPoints(n.getGeometry(),t.extend,t)})),this.googleApis.map.fitBounds(t);var n=this.googleApis.map.getZoom();this.googleApis.map.setZoom(n>8?8:n)},processPoints:function(e,t,n){e instanceof window.google.maps.LatLng?t.call(n,e):e instanceof window.google.maps.Data.Point?t.call(n,e.get()):e.getArray().forEach((function(e){this.processPoints(e,t,n)}))},panTo:function(e){var t=e.station.latitude,n=e.station.longitude;this.googleApis.map.panTo({lat:t,lng:n})},calcRoute:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var o,i,a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=e.start,i=e.end,a=e.tasks,r=e.optimized,n.abrupt("return",new Promise((function(e){var n={},s=[],c="",u=a.map((function(e){var t=Number.parseFloat(e.station.latitude),n=Number.parseFloat(e.station.longitude);return{location:new window.google.maps.LatLng({lat:t,lng:n}),stopover:!0}})),p={origin:o,destination:i,waypoints:u,optimizeWaypoints:!!r,provideRouteAlternatives:!0,travelMode:"DRIVING"};t.googleApis.directionsService.route(p,(function(o,i){return"OK"==i&&(t.googleApis.directionsRenderer.setDirections(o),n=o.routes[0].legs,s=o.routes[0].waypoint_order,c=t.buildLink(n)),e({info:Object(l["a"])(n),order:s,link:c})}))})));case 2:case"end":return n.stop()}}),n)})))()},buildLink:function(e){for(var t="https://www.google.com/maps/dir/?api=1&travelmode=driving&origin=".concat(encodeURI(e[0].start_address),"&waypoints="),n=0;n<e.length-1;n++)t+=encodeURI(e[n].end_address),n<e.length-2&&(t+="|");return t+="&destination=".concat(encodeURI(e[e.length-1].end_address)),t}}},p=u,d=n("2f62"),g={mixins:[p],props:{organizations:Array},data:function(){return{loading:!1}},computed:Object(r["a"])(Object(r["a"])({},Object(d["c"])(["mapFilters"])),{},{markers:function(){var e={type:"FeatureCollection",features:[]};if(!this.organizations.length)return e;var t=this.organizations.map((function(e){var t;return{type:"Feature",properties:{title:e.Caption_small,phone:null===(t=e.Contact)||void 0===t?void 0:t.Phone,icon:"fa-star"},id:e.id,geometry:{type:"Point",coordinates:[Number.parseFloat(e.Contact.Longitude),Number.parseFloat(e.Contact.Latitude)]}}}));return e.features=t,e}}),watch:{markers:{handler:function(e){"google"in window&&this.setMarkers(e)}}},mounted:function(){var e=this;this.loadMapScript().then((function(){e.initMap(),e.setMarkers(e.markers)})),this.$on("google.data.click",(function(t){var n=t.feature.getProperty("title"),o=t.feature.getProperty("phone"),i='\n        <div style="padding:1rem;">\n          <div class="title">\n            '.concat(n,'\n          </div>\n          <div class="subtitle mt-3">\n            ').concat(o,"\n          </div>\n        </div>\n      "),a=new window.google.maps.InfoWindow({content:i});a.setPosition(t.latLng),a.open(e.googleApis.map,new window.google.maps.MVCObject)}))}},m=g,f=(n("894b"),n("2877")),v=Object(f["a"])(m,s,c,!1,null,null,null),h=v.exports,w={components:{Map:h},data:function(){return{organizations:[],loading:!1,mapIcons:{Dost_Kolyas:"mdi-wheelchair-accessibility",Dost_ODA:"mdi-human-cane",Dost_Sluh:"mdi-ear-hearing-off",Dost_Um:"mdi-brain",Dost_Zren:"mdi-eye-off"}}},computed:Object(r["a"])({},Object(d["c"])(["mapList","mapFilters"])),watch:{mapFilters:{deep:!0,handler:function(){this.getOrgs()}}},metaInfo:function(){return{meta:[]}},mounted:function(){this.getOrgs()},methods:{getOrgs:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,o,i,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="/api/freeenv/getresult",o=e.mapFilters.region,i=e.mapFilters.sfera,a='{"inputsParam":\'{"regnId":"66053000","regnText":"'.concat(o,'","sferaId":"11","sferaText":"').concat(i,'","vidId":null,"vidText":null,"captionId":null,"captionText":null,"captionOsiId":null,"captionOsiText":null}\'}'),r={"Content-Type":"application/json"},t.next=7,e.callApi({url:n,data:a,headers:r});case 7:case"end":return t.stop()}}),t)})))()},callApi:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var o,i,a,r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=e.url,i=e.data,a=e.headers,t.loading=!0,n.prev=2,n.next=5,t.$axios.post(o,i,{headers:a});case 5:r=n.sent,s=JSON.parse(r.data.d).Result,t.organizations=s,n.next=13;break;case 10:n.prev=10,n.t0=n["catch"](2),console.log(n.t0);case 13:t.loading=!1;case 14:case"end":return n.stop()}}),n,null,[[2,10]])})))()}}},b=w,A=(n("3321"),n("6544")),y=n.n(A),k=n("a523"),I=n("ce7e"),L=n("132d"),_=n("8860"),x=n("da13"),P=n("1800"),O=n("5d23"),R=Object(f["a"])(b,o,i,!1,null,null,null);t["default"]=R.exports;y()(R,{VContainer:k["a"],VDivider:I["a"],VIcon:L["a"],VList:_["a"],VListItem:x["a"],VListItemAction:P["a"],VListItemContent:O["a"],VListItemSubtitle:O["b"],VListItemTitle:O["c"]})},"7e12":function(e,t,n){var o=n("da84"),i=n("58a8").trim,a=n("5899"),r=o.parseFloat,s=1/r(a+"-0")!==-1/0;e.exports=s?function(e){var t=i(String(e)),n=r(t);return 0===n&&"-"==t.charAt(0)?-0:n}:r},"894b":function(e,t,n){"use strict";n("a8f9")},a8f9:function(e,t,n){},c20d:function(e,t,n){var o=n("da84"),i=n("58a8").trim,a=n("5899"),r=o.parseInt,s=/^[+-]?0[Xx]/,c=8!==r(a+"08")||22!==r(a+"0x16");e.exports=c?function(e,t){var n=i(String(e));return r(n,t>>>0||(s.test(n)?16:10))}:r},c35a:function(e,t,n){var o=n("23e7"),i=n("7e12");o({target:"Number",stat:!0,forced:Number.parseFloat!=i},{parseFloat:i})}}]);
//# sourceMappingURL=business.cf9e9411.js.map